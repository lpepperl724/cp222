Code from a while back, seems to be calculating correctly, but simple.

copied over code again, error probably due to some exception code not being there
